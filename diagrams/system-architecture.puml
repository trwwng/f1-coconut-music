@startuml Coconut_Music_System_Architecture
!theme cerulean-outline
title Kiáº¿n trÃºc mÃ£ nguá»“n Back-end - Coconut Music Platform

skinparam rectangle {
    BackgroundColor LightBlue
    BorderColor DarkBlue
    FontName Arial
    FontSize 12
}

skinparam database {
    BackgroundColor LightGreen
    BorderColor DarkGreen
}

skinparam cloud {
    BackgroundColor LightYellow
    BorderColor Orange
}

skinparam arrow {
    Color Black
    FontSize 10
}

' Frontend
rectangle "ðŸ…°ï¸ Angular\nFrontend" as angular {
    rectangle "Components" as comp
    rectangle "Services" as services
    rectangle "Guards" as guards
}

' Nginx
rectangle "ðŸ”§ NGINX\nReverse Proxy" as nginx {
    note bottom : Chuyá»ƒn tiáº¿p API Request
}

' Spring Boot Backend vá»›i cÃ¡c layer
rectangle "ðŸƒ Spring Boot\nBackend" as springboot {
    rectangle "ðŸŽ® Controller\nLayer" as controller #LightCoral
    rectangle "âš™ï¸ Service\nLayer" as service #LightGoldenRodYellow
    rectangle "ðŸ—„ï¸ Repository\nLayer" as repository #LightSeaGreen
}

' Database
database "ðŸ—ƒï¸ MySQL\nDatabase" as mysql {
    rectangle "10 Tables" as tables
    rectangle "15 Foreign Keys" as fks
    rectangle "6 Unique Constraints" as constraints
}

' Firebase Storage
cloud "ðŸ”¥ Firebase\nStorage" as firebase {
    rectangle "Audio Files" as audio
    rectangle "Images" as images
}

' Connections vá»›i labels
angular --> nginx : "HTTP Requests"
nginx --> controller : "API Calls"
controller --> service : "Business Logic"
service --> repository : "Data Access"
repository --> mysql : "JDBC/JPA\nHibernate"

' Firebase connections
service --> firebase : "File Upload/\nDownload"
angular -.-> firebase : "Direct Media\nStreaming"

' Notes for each layer
note top of angular : "**Frontend Layer**\nâ€¢ User Interface\nâ€¢ Component-based Architecture\nâ€¢ RxJS Reactive Programming\nâ€¢ Route Guards & Lazy Loading"

note top of nginx : "**Proxy Layer**\nâ€¢ Static File Serving\nâ€¢ Load Balancing\nâ€¢ SSL Termination\nâ€¢ Request Routing"

note right of springboot : "**Backend Layers**\nâ€¢ **Controller**: REST API Endpoints\nâ€¢ **Service**: Business Logic & Validation\nâ€¢ **Repository**: Data Access with JPA"

note bottom of mysql : "**Database Schema**\nâ€¢ Users, Artists, Categories\nâ€¢ Music, Playlists, History\nâ€¢ Favorites, Banners\nâ€¢ Normalized 3NF Design"

note bottom of firebase : "**Media Storage**\nâ€¢ CDN Distribution\nâ€¢ Scalable File Storage\nâ€¢ Direct Stream Access"

' Technology stack info
package "ðŸ› ï¸ Technology Stack" {
    rectangle "Frontend" as fe_tech #LightBlue {
        **Angular 17**
        TypeScript
        RxJS
        Angular Material
    }

    rectangle "Backend" as be_tech #LightGreen {
        **Spring Boot 3.x**
        Java 17
        Spring Security
        Spring Data JPA
    }

    rectangle "Database" as db_tech #LightYellow {
        **MySQL 8.0**
        InnoDB Engine
        UTF8MB4
        HikariCP Pool
    }

    rectangle "Infrastructure" as infra_tech #LightPink {
        **Nginx**
        Docker
        Firebase
        JWT Auth
    }
}

' Security flow
package "ðŸ” Security Flow" as security {
    rectangle "Authentication" as auth #LightCoral
    rectangle "Authorization" as authz #LightSalmon
    rectangle "JWT Token" as jwt #MistyRose

    auth --> jwt : "Generate"
    jwt --> authz : "Validate"
    authz --> service : "Access Control"
}

' Data flow arrows
angular -.-> auth : "Login/Register"
controller -.-> security : "Security Check"

@enduml
